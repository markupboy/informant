(function(b,a){var c=function(d,b){this.options=a.extend({},this.defaults,b);this.scope=a(d);this.inform=!1;this.init()};c.prototype={init:function(){this.initialState=this.captureState();this.on()},on:function(){a(b).on("beforeunload.informant",function(){if(this.inform)return this.options.message}.bind(this));this.scope.on("change.informant",function(){this.inform=this.initialState!=this.captureState()}.bind(this));this.scope.on("submit.informant",function(){this.inform=!1;this.initialState=this.captureState}.bind(this))},
off:function(){a(b).off("beforeunload.informant");this.scope.off("submit.informant change.informant")},captureState:function(){return this.scope.serialize()},defaults:{message:"All unsaved changes will be lost."}};a.fn.informant=function(b){return a(this).each(function(){a(this).data("informant",new c(this,b))})}})(window,jQuery);
